#!/bin/bash
#
# Patch stdin with the given patch files.
#
# Example:
#
#   curl URL | filter-patch -i mod.patch
#

set -o errexit
tmpdir="$(mktemp -d)"
trap 'rm -rf -- "$tmpdir"' EXIT
trap 'exit 1' HUP INT TERM
cat >"$tmpdir/original"
patch "$@" -o "$tmpdir/patched" "$tmpdir/original"
cat "$tmpdir/patched"
