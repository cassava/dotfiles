# ~/.zalias
# vim: set ft=zsh:
#
# This file contains extra alias definitions for the interactive Zsh
# and can be sourced by .zshrc
#

#
# READABILITY
#
if [[ -f ~/.dircolors ]]; then
    eval "$(dircolors -b ~/.dircolors)"
else
    eval "$(dircolors -b)"
fi

alias ls='ls -bhCF --color=auto'
alias ll='ls -l'
alias la='ls -a'
alias lm="la | ${PAGER}"
alias lal='ls -al'
if whence tree >/dev/null; then
    alias lr='tree'
fi
if whence lsd >/dev/null; then
    alias lsd='lsd --classify --group-directories-first'
    alias ls='lsd'
    alias lr='lsd --tree'
    alias lx='lsd -X'
fi

alias lsblk='lsblk -o NAME,RM,SIZE,RO,TYPE,MOUNTPOINT,UUID'
alias rg='rg --max-columns=192 --max-columns-preview'
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'

if whence bat >/dev/null; then
    alias cat='bat --style=changes,header,numbers,snip'
fi

alias df='df -h'
alias du='du -h'

#
# SAFETY
#
alias cp='nocorrect cp'
alias mkdir='nocorrect mkdir -p'
alias mv='nocorrect mv'
alias rm='nocorrect rm'

#
# SYSTEM
#
if whence pacman >/dev/null; then
    alias pacman='pacman --color=auto'
fi
alias sys="sudo systemctl"
alias sysu="systemctl --user"
alias sue="sudoedit"

# Chezmoi aliases
alias ched="chezmoi edit"
alias chezvous="chezmoi -c ~/.config/chezvous/chezvous.yaml -S ~/.local/share/chezvous"

#
# EDITOR
#
alias vim="nvim"
alias vimi="chezmoi edit ~/.config/nvim"
alias vi="nvim --clean"

#
# FUNCTIONS
#
function cdz() {
    builtin cd $(git rev-parse --show-toplevel)
}

function mkcd() {
    [[ -n ${1} ]] && mkdir -p ${1} && builtin cd ${1}
}

function pass() {
    # Protect passwords from plugins and other Neovim persistent features
    EDITOR="nvim --clean -u NONE -i NONE -n" /usr/bin/pass "$@"
}

function pwgen() {
    if whence pwgen-passphrase >/dev/null; then
        pwgen-passphrase -w aspell-en -s. -n10
    else
        LC_CTYPE=C command tr -dc ${2:-'[:alnum:]'} < /dev/urandom | command head -c ${1:-32} && print
    fi
}

function vimz() {
    nvim "$(which "$1")"
}

function vimo() {
    # Open notes from last recorded day and today side-by-side.
    # Can't use +Obsidian yesterday because of mini.starter hijacking.
    local yesterday="$(find ~/notes/dailies | sort | grep -v $(date +"%Y-%m-%d.md") | tail -1)"
    nvim "$yesterday" +"wincmd v" +"Obsidian today"
}

