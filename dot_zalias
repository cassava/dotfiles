# ~/.zalias
# vim: set ft=zsh:
#
# This file contains extra alias definitions for the interactive Zsh
# and can be sourced by .zshrc
#

#
# READABILITY
#
if [[ -f ~/.dircolors ]]; then
    eval "$(dircolors -b ~/.dircolors)"
else
    eval "$(dircolors -b)"
fi

alias ls='ls -bhCF --color=auto'
alias ll='ls -l'
alias la='ls -a'
alias lm="la | ${PAGER}"
alias lal='ls -al'
if whence tree >/dev/null; then
    alias lr='tree -L2'
    alias lrd='tree -d'
    alias lra='tree -a'
    alias lrn='tree -L'
fi
if whence lsd >/dev/null; then
    alias lsd='lsd -hF --group-directories-first'
    alias ls='lsd'
    alias lx='lsd -X'       # sort by extension
    alias ll='lsd -lg'      # long-form with git status

    # Better tree
    alias lr='lsd --tree --depth=2'
    alias lrd='lsd --tree -d'
    alias lra='lsd --tree -a'
    alias lrn='lsd --tree --depth'
fi
alias k='k -h'

alias lsblk='lsblk -o NAME,RM,SIZE,RO,TYPE,MOUNTPOINT,UUID'
alias rg='rg --max-columns=192 --max-columns-preview'
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'

if whence bat >/dev/null; then
    alias cat='bat --style=changes,header,numbers,snip'
fi

alias df='df -h'
alias du='du -h'

#
# SAFETY
#
alias cp='nocorrect cp'
alias mkdir='nocorrect mkdir -p'
alias mv='nocorrect mv'
alias rm='nocorrect rm'

#
# SYSTEM
#
if whence pacman >/dev/null; then
    alias pacman='pacman --color=auto'
fi
alias sys="sudo systemctl"
alias sysu="systemctl --user"
alias sue="sudoedit"

# Chezmoi aliases
alias ched="chezmoi edit"
alias chezvous="chezmoi -c ~/.config/chezvous/chezvous.yaml -S ~/.local/share/chezvous"

#
# FUNCTIONS
#
function cdz() {
    builtin cd $(git rev-parse --show-toplevel)
}

function mkcd() {
    [[ -n ${1} ]] && mkdir -p ${1} && builtin cd ${1}
}

function pass() {
    # Protect passwords from plugins and other Neovim persistent features
    EDITOR="nvim --clean -u NONE -i NONE -n" /usr/bin/pass "$@"
}

function pwgen() {
    if whence pwgen-passphrase >/dev/null; then
        pwgen-passphrase -w aspell-en -s. -n10
    else
        LC_CTYPE=C command tr -dc ${2:-'[:alnum:]'} < /dev/urandom | command head -c ${1:-32} && print
    fi
}

#
# EDITOR
#
alias vim="nvim"
alias vi="nvim --clean"
alias vip="nvim --clean -u NONE -i NONE -n"

function vimi() { chezmoi edit ~/.config/nvim }
function vimz() { nvim "$(which "$1")" }
function vimo() { nvim +'lua require("sessions.daily").launch()' }
function vimc() { nvim +'lua require("codecompanion").chat({window_opts={layout="fullscreen"}})' }
function vimd() { nvim_picker dir_containing "$@" }
function vimf() { nvim_picker files "$@" }
function vimg() { nvim_picker git_files "$@" }

function nvim_picker() {
    local picker="$1"; shift;
    nvim +"lua require('sessions.picker').$picker \"$@\""
}
